# –ö—Ä–∞—Ç–∫–∏–π –∫—É—Ä—Å: Data Warehouse –∏ BigQuery
## Data Engineering Zoomcamp - Week 3

---

## –ú–æ–¥—É–ª—å 3.1: –ü–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –≤ BigQuery

### 3.1.1 –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏

#### –¢–∏–ø—ã –ø–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

**1. –ü–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ –≤—Ä–µ–º–µ–Ω–Ω–æ–π –µ–¥–∏–Ω–∏—Ü–µ (Time Unit Column)**
- **Daily (–µ–∂–µ–¥–Ω–µ–≤–Ω–æ–µ)** - –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, —Ö–æ—Ä–æ—à–∏–π —Å—Ç–∞—Ä—Ç –¥–ª—è —Å—Ä–µ–¥–Ω–∏—Ö –æ–±—ä–µ–º–æ–≤ –¥–∞–Ω–Ω—ã—Ö
- **Hourly (–µ–∂–µ—á–∞—Å–Ω–æ–µ)** - –¥–ª—è –æ–≥—Ä–æ–º–Ω—ã—Ö –æ–±—ä–µ–º–æ–≤ –¥–∞–Ω–Ω—ã—Ö, –∫–æ–≥–¥–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏–¥–µ—Ç –ø–æ —á–∞—Å–∞–º
  - ‚ö†Ô∏è **–í–∞–∂–Ω–æ**: –õ–∏–º–∏—Ç - 4000 –ø–∞—Ä—Ç–∏—Ü–∏–π –Ω–∞ —Ç–∞–±–ª–∏—Ü—É
  - –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –∞–≤—Ç–æ—É–¥–∞–ª–µ–Ω–∏—è —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –ø–∞—Ä—Ç–∏—Ü–∏–π
- **Monthly (–µ–∂–µ–º–µ—Å—è—á–Ω–æ–µ)** - –¥–ª—è –º–∞–ª—ã—Ö –æ–±—ä–µ–º–æ–≤ –¥–∞–Ω–Ω—ã—Ö, —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –Ω–∞ –±–æ–ª—å—à–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–∏–∞–ø–∞–∑–æ–Ω—ã
- **Yearly (–µ–∂–µ–≥–æ–¥–Ω–æ–µ)** - –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ –º–µ—Å—è—á–Ω–æ–º—É

**2. –ü–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –∑–∞–≥—Ä—É–∑–∫–∏ (Ingestion Time)**

**3. –ü–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–æ–º—É –¥–∏–∞–ø–∞–∑–æ–Ω—É (Integer Range)**

#### –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è

**–ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∞–≤–∏–ª–∞:**
- –°—Ç–æ–ª–±—Ü—ã –¥–ª—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ —Ä–∞—Å–ø–æ–ª–∞–≥–∞—é—Ç—Å—è —Å–æ–≤–º–µ—Å—Ç–Ω–æ (co-located)
- **–ü–æ—Ä—è–¥–æ–∫ —Å—Ç–æ–ª–±—Ü–æ–≤ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–µ–Ω** - –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø–æ—Ä—è–¥–æ–∫ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö
- –ü—Ä–∏–º–µ—Ä: –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –ø–æ —Å—Ç–æ–ª–±—Ü–∞–º A, B, C ‚Üí —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ —Å–Ω–∞—á–∞–ª–∞ –ø–æ A, –∑–∞—Ç–µ–º –ø–æ B, –∑–∞—Ç–µ–º –ø–æ C

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏:**
- –î–æ 4 —Å—Ç–æ–ª–±—Ü–æ–≤ –¥–ª—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏
- –¢–æ–ª—å–∫–æ top-level, –Ω–µ –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è —Å—Ç–æ–ª–±—Ü—ã
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö:
  - DATE
  - BOOLEAN
  - GEOGRAPHY
  - INT
  - NUMERIC
  - STRING
  - DATETIME

**–ö–æ–≥–¥–∞ –ù–ï –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ/–∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—é:**
- –†–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö < 1 GB
- –ü—Ä–∏—á–∏–Ω–∞: –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞—Ç—Ä–∞—Ç—ã –Ω–∞ —á—Ç–µ–Ω–∏–µ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫—É –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö

### 3.1.2 –°—Ä–∞–≤–Ω–µ–Ω–∏–µ: –ü–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ vs –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è

#### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

| –ö—Ä–∏—Ç–µ—Ä–∏–π | –ü–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ | –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è |
|----------|-------------------|---------------|
| **–°—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–æ–≤** | –ò–∑–≤–µ—Å—Ç–Ω–∞ –∑–∞—Ä–∞–Ω–µ–µ | –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞ –∑–∞—Ä–∞–Ω–µ–µ |
| **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏** | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø–∞—Ä—Ç–∏—Ü–∏–π (—É–¥–∞–ª–µ–Ω–∏–µ, –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ) | –ù–µ–¥–æ—Å—Ç—É–ø–Ω–æ |
| **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç–æ–ª–±—Ü–æ–≤** | –¢–æ–ª—å–∫–æ 1 —Å—Ç–æ–ª–±–µ—Ü | –î–æ 4 —Å—Ç–æ–ª–±—Ü–æ–≤ |
| **–õ–∏–º–∏—Ç –ø–∞—Ä—Ç–∏—Ü–∏–π** | –ú–∞–∫—Å–∏–º—É–º 4000 | –ù–µ—Ç –ª–∏–º–∏—Ç–∞ |

#### –ö–æ–≥–¥–∞ –≤—ã–±–∏—Ä–∞—Ç—å –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—é

‚úÖ **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—é –∫–æ–≥–¥–∞:**
- –ù—É–∂–Ω–∞ –±–æ–ª—å—à–∞—è –≥—Ä–∞–Ω—É–ª—è—Ä–Ω–æ—Å—Ç—å, —á–µ–º –º–æ–∂–µ—Ç –æ–±–µ—Å–ø–µ—á–∏—Ç—å –ø–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è/–∞–≥—Ä–µ–≥–∞—Ü–∏—è –ø–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º —Å—Ç–æ–ª–±—Ü–∞–º
- –í—ã—Å–æ–∫–∞—è –∫–∞—Ä–¥–∏–Ω–∞–ª—å–Ω–æ—Å—Ç—å (–±–æ–ª—å—à–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π) –≤ —Å—Ç–æ–ª–±—Ü–µ
- –ü–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –º–∞–ª–æ–º—É –æ–±—ä–µ–º—É –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –ø–∞—Ä—Ç–∏—Ü–∏—é (< 1 GB)
- –ü–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–∑–¥–∞–µ—Ç > 4000 –ø–∞—Ä—Ç–∏—Ü–∏–π
- –ß–∞—Å—Ç—ã–µ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –ø–∞—Ä—Ç–∏—Ü–∏–π

#### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è BigQuery

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
- –ù–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –±–ª–æ–∫–∏
- –≠—Ç–∏ –±–ª–æ–∫–∏ –º–æ–≥—É—Ç –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏
- BigQuery –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∫–ª–∞—Å—Ç–µ—Ä–∏–∑—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- ‚úÖ –ù–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚úÖ **–ü–æ–ª–Ω–æ—Å—Ç—å—é –±–µ—Å–ø–ª–∞—Ç–Ω–æ**
- ‚úÖ –î–ª—è –ø–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü - –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –≤ —Ä–∞–º–∫–∞—Ö –∫–∞–∂–¥–æ–π –ø–∞—Ä—Ç–∏—Ü–∏–∏

---

## –ú–æ–¥—É–ª—å 3.2: Best Practices –¥–ª—è BigQuery

### 3.2.1 –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å—Ç–æ–∏–º–æ—Å—Ç–∏

#### –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ —Å–Ω–∏–∂–µ–Ω–∏—è –∑–∞—Ç—Ä–∞—Ç

**1. –ò–∑–±–µ–≥–∞–π—Ç–µ SELECT ***
```sql
-- ‚ùå –ü–ª–æ—Ö–æ
SELECT * FROM table;

-- ‚úÖ –•–æ—Ä–æ—à–æ
SELECT column1, column2, column3 FROM table;
```
**–ü—Ä–∏—á–∏–Ω–∞:** BigQuery —Ö—Ä–∞–Ω–∏—Ç –¥–∞–Ω–Ω—ã–µ –≤ –∫–æ–ª–æ–Ω–æ—á–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ - –≤—ã–±–æ—Ä–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Å—Ç–æ–ª–±—Ü–æ–≤ —á–∏—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

**2. –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Å—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–∞ –ø–µ—Ä–µ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º**
- –°—Ç–æ–∏–º–æ—Å—Ç—å –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ –ø—Ä–∞–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ª–∏–º–∏—Ç—ã —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤

**3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—é**

**4. –û—Å—Ç–æ—Ä–æ–∂–Ω–æ —Å–æ streaming inserts**
- –ú–æ–≥—É—Ç —Ä–µ–∑–∫–æ —É–≤–µ–ª–∏—á–∏—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å

**5. –ú–∞—Ç–µ—Ä–∏–∞–ª–∏–∑—É–π—Ç–µ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã**
- –ï—Å–ª–∏ CTE –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–µ—Å—Ç–∞—Ö - –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑—É–π—Ç–µ –µ–≥–æ

**6. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∑–∞–ø—Ä–æ—Å–æ–≤**
- BigQuery –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫—ç—à–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### 3.2.2 –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∑–∞–ø—Ä–æ—Å–æ–≤

#### –ö–ª—é—á–µ–≤—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

**1. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è**
- –í—Å–µ–≥–¥–∞ —Ñ–∏–ª—å—Ç—Ä—É–π—Ç–µ –ø–æ –ø–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–º/–∫–ª–∞—Å—Ç–µ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–º —Å—Ç–æ–ª–±—Ü–∞–º

**2. –î–µ–Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö**
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤–ª–æ–∂–µ–Ω–Ω—ã–µ (nested) –∏–ª–∏ –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è (repeated) —Å—Ç–æ–ª–±—Ü—ã
- –ü–æ–º–æ–≥–∞–µ—Ç –ø—Ä–∏ —Å–ª–æ–∂–Ω—ã—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä–∞—Ö –¥–∞–Ω–Ω—ã—Ö

**3. –í–Ω–µ—à–Ω–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö**
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–∞–∑—É–º–Ω–æ (–Ω–∞–ø—Ä–∏–º–µ—Ä, Google Cloud Storage)
- –ß—Ç–µ–Ω–∏–µ –≤–Ω–µ—à–Ω–∏—Ö –¥–∞–Ω–Ω—ã—Ö –º–æ–∂–µ—Ç —É–≤–µ–ª–∏—á–∏—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å

**4. JOIN –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è**
- –£–º–µ–Ω—å—à–∞–π—Ç–µ –æ–±—ä–µ–º –¥–∞–Ω–Ω—ã—Ö –î–û JOIN
- **–ü–æ—Ä—è–¥–æ–∫ —Ç–∞–±–ª–∏—Ü –≤ JOIN –∫—Ä–∏—Ç–∏—á–µ–Ω:**
  1. –°–∞–º–∞—è –±–æ–ª—å—à–∞—è —Ç–∞–±–ª–∏—Ü–∞ - –ü–ï–†–í–û–ô (—Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ø–æ —É–∑–ª–∞–º)
  2. –¢–∞–±–ª–∏—Ü–∞ —Å –Ω–∞–∏–º–µ–Ω—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Å—Ç—Ä–æ–∫ - –í–¢–û–†–û–ô (broadcast –Ω–∞ –≤—Å–µ —É–∑–ª—ã)
  3. –û—Å—Ç–∞–ª—å–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã - –ø–æ —É–±—ã–≤–∞–Ω–∏—é —Ä–∞–∑–º–µ—Ä–∞

**5. –ò–∑–±–µ–≥–∞–π—Ç–µ:**
- ‚ùå JavaScript UDF (user-defined functions)
- ‚ùå –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è WITH –∫–∞–∫ prepared statement
- ‚ùå –ò–∑–±—ã—Ç–æ—á–Ω–æ–≥–æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü (over-sharding)

**6. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ:**
- ‚úÖ Approximation aggregation functions (–Ω–∞–ø—Ä–∏–º–µ—Ä, HyperLogLog++)
- ‚úÖ ORDER BY –≤ –∫–æ–Ω—Ü–µ –∑–∞–ø—Ä–æ—Å–∞ –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

---

## –ú–æ–¥—É–ª—å 3.3: –í–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ BigQuery

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ BigQuery

#### –¢—Ä–∏ –æ—Å–Ω–æ–≤–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞

**1. Colossus - –•—Ä–∞–Ω–∏–ª–∏—â–µ –¥–∞–Ω–Ω—ã—Ö**
- –î–µ—à–µ–≤–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
- –ö–æ–ª–æ–Ω–æ—á–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö
- **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ:** —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π
- –ù–∏–∑–∫–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø—Ä–∏ —Ä–æ—Å—Ç–µ –æ–±—ä–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö

**2. Jupiter Network - –°–µ—Ç—å**
- –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è —Å–µ—Ç—å –¥–∞—Ç–∞-—Ü–µ–Ω—Ç—Ä–æ–≤ BigQuery
- –°–∫–æ—Ä–æ—Å—Ç—å: ~1 –ø–µ—Ç–∞–±–∞–π—Ç/—Å–µ–∫—É–Ω–¥—É
- **–†–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É:** –±—ã—Å—Ç—Ä–∞—è –ø–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É —Ö—Ä–∞–Ω–∏–ª–∏—â–µ–º –∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è–º–∏

**3. Dremel - –î–≤–∏–∂–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤**
- –†–∞–∑–¥–µ–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å –Ω–∞ –¥—Ä–µ–≤–æ–≤–∏–¥–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É
- –ö–∞–∂–¥—ã–π —É–∑–µ–ª –≤—ã–ø–æ–ª–Ω—è–µ—Ç –ø–æ–¥–∑–∞–ø—Ä–æ—Å

### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç Dremel

#### –ü—Ä–∏–º–µ—Ä –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞

**–ó–∞–ø—Ä–æ—Å:**
```sql
SELECT A, COUNT(B) 
FROM table_D 
GROUP BY A
```

**–ü—Ä–æ—Ü–µ—Å—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:**

1. **Root Server (–∫–æ—Ä–Ω–µ–≤–æ–π —Å–µ—Ä–≤–µ—Ä)**
   - –ü–æ–ª—É—á–∞–µ—Ç –∑–∞–ø—Ä–æ—Å
   - –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç: `SELECT A, SUM(C)`
   - –†–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø–æ Mixers

2. **Mixers (–º–∏–∫—Å–µ—Ä—ã)**
   - –ü–æ–ª—É—á–∞—é—Ç –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å
   - –î–∞–ª—å—à–µ —Ä–∞–∑–¥–µ–ª—è—é—Ç –Ω–∞ –ø–æ–¥–∑–∞–ø—Ä–æ—Å—ã R1, R2, ..., Rn
   - –ü–µ—Ä–µ–¥–∞—é—Ç Leaf Nodes

3. **Leaf Nodes (–∫–æ–Ω–µ—á–Ω—ã–µ —É–∑–ª—ã)**
   - –ó–∞–ø—Ä–∞—à–∏–≤–∞—é—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ Colossus
   - –í—ã–ø–æ–ª–Ω—è—é—Ç –æ–ø–µ—Ä–∞—Ü–∏–∏
   - –í–æ–∑–≤—Ä–∞—â–∞—é—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã Mixers

4. **–ê–≥—Ä–µ–≥–∞—Ü–∏—è**
   - Mixers –∞–≥—Ä–µ–≥–∏—Ä—É—é—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
   - –ü–µ—Ä–µ–¥–∞—é—Ç Root Server
   - Root Server –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ñ–∏–Ω–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

**–ü–æ—á–µ–º—É BigQuery –±—ã—Å—Ç—Ä—ã–π:**
- –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã
- –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å —á–µ—Ä–µ–∑ leaf nodes
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –µ–¥–∏–Ω–æ–π —Ç–æ—á–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏

### –ö–æ–ª–æ–Ω–æ—á–Ω–æ–µ vs –°—Ç—Ä–æ—á–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ

**Record-oriented (—Å—Ç—Ä–æ—á–Ω–æ–µ):**
```
R1: [C1, C2, C3]
R2: [C1, C2, C3]
```
- –õ–µ–≥–∫–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å
- –ü–æ—Ö–æ–∂–µ –Ω–∞ CSV

**Column-oriented (–∫–æ–ª–æ–Ω–æ—á–Ω–æ–µ):**
```
C1: [R1, R2]
C2: [R1, R2]
C3: [R1, R2]
```
- –õ—É—á—à–µ –¥–ª—è –∞–≥—Ä–µ–≥–∞—Ü–∏–π –ø–æ —Å—Ç–æ–ª–±—Ü–∞–º
- –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–µ–µ –ø—Ä–∏ –≤—ã–±–æ—Ä–∫–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å—Ç–æ–ª–±—Ü–æ–≤

---

## –ú–æ–¥—É–ª—å 3.4: Machine Learning –≤ BigQuery

### 3.4.1 –û–±–∑–æ—Ä BigQuery ML

#### –¶–µ–ª–µ–≤–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è
- Data Analysts
- Managers
- **–ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –∑–Ω–∞–Ω–∏–µ Python –∏–ª–∏ Java**
- –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ SQL + –ø–æ–Ω–∏–º–∞–Ω–∏–µ ML –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤

#### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

‚úÖ **–ù–µ –Ω—É–∂–Ω–æ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ**
- –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –ø—Ä—è–º–æ –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–∞–Ω–Ω—ã—Ö
- –ò—Å–∫–ª—é—á–µ–Ω–∏–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ —à–∞–≥–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞

#### –¶–µ–Ω–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ (–°–®–ê)

**–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å:**
- 10 GB —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
- 1 TB –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤/–º–µ—Å—è—Ü
- 10 GB –¥–ª—è CREATE MODEL/–º–µ—Å—è—Ü

**–ü–ª–∞—Ç–Ω—ã–µ —Ç–∞—Ä–∏—Ñ—ã:**
- $250/TB: Logistic Regression, Linear Regression, Clustering, Time Series
- $5/TB: AutoML Tables, Boosted Trees (+ –∑–∞—Ç—Ä–∞—Ç—ã –Ω–∞ Vertex AI)

‚ö†Ô∏è **–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Ü–µ–Ω—ã –¥–ª—è –≤–∞—à–µ–≥–æ —Ä–µ–≥–∏–æ–Ω–∞!**

### –≠—Ç–∞–ø—ã ML —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –≤ BigQuery

#### –¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥

1. –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö
2. –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏ feature engineering
3. –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ train/test
4. –í—ã–±–æ—Ä –∞–ª–≥–æ—Ä–∏—Ç–º–∞
5. –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
6. Hyperparameter tuning
7. –í–∞–ª–∏–¥–∞—Ü–∏—è
8. –î–µ–ø–ª–æ–π

#### –ß—Ç–æ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç BigQuery ML

‚úÖ Feature engineering (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∏ —Ä—É—á–Ω–æ–π)
‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
‚úÖ –í—ã–±–æ—Ä –∏–∑ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤
‚úÖ Hyperparameter tuning
‚úÖ –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏
‚úÖ –î–µ–ø–ª–æ–π —á–µ—Ä–µ–∑ Docker

### –í—ã–±–æ—Ä –∞–ª–≥–æ—Ä–∏—Ç–º–∞

#### –ü–æ —Ç–∏–ø—É –∑–∞–¥–∞—á–∏

**–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π (Regression):**
- Stock prices, sales figures
- –ê–ª–≥–æ—Ä–∏—Ç–º—ã: Linear Regression, Boosted Tree, AutoML, DNN Regressor, Wide & Deep

**–°–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è (Clustering):**
- Customer segmentation
- –ê–ª–≥–æ—Ä–∏—Ç–º: K-means

**–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è (Classification):**
- Spam detection, –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è
- –ê–ª–≥–æ—Ä–∏—Ç–º—ã: Logistic Regression, Boosted Tree Classifier, AutoML Tables

### 3.4.2 –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä: –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ —á–∞–µ–≤—ã—Ö

#### –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö

**Dataset:** Yellow Trip Data (–ø–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π)

**–¶–µ–ª–µ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è:** tip_amount

**–ü—Ä–∏–∑–Ω–∞–∫–∏ (features):**
- passenger_count
- trip_distance
- PULocationID
- DOLocationID
- payment_type
- fare_amount
- tolls_amount

**–§–∏–ª—å—Ç—Ä:** fare_amount != 0

#### Feature Preprocessing –≤ BigQuery

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞:**
- –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è —á–∏—Å–ª–æ–≤—ã—Ö –ø–æ–ª–µ–π
- One-hot encoding –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π
- Multi-hot encoding –º–∞—Å—Å–∏–≤–æ–≤

**–†—É—á–Ω–∞—è –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ (–¥–æ—Å—Ç—É–ø–Ω–∞):**
- Bucketization
- Polynomial expansion
- Feature cross
- N-grams
- Min/Max scaler

#### –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö

```sql
CREATE OR REPLACE TABLE yellow_trip_data_ml AS
SELECT
  passenger_count,
  trip_distance,
  CAST(PULocationID AS STRING) as pickup_location_id,
  CAST(DOLocationID AS STRING) as dropoff_location_id,
  CAST(payment_type AS STRING) as payment_type,
  fare_amount,
  tolls_amount,
  tip_amount
FROM yellow_trip_data_partitioned
WHERE fare_amount != 0
```

**–ü—Ä–∏—á–∏–Ω–∞:** –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ INT ‚Üí STRING –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (–¥–ª—è one-hot encoding)

#### –°–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏

```sql
CREATE OR REPLACE MODEL tip_model
OPTIONS(
  model_type='LINEAR_REG',
  input_label_cols=['tip_amount'],
  data_split_method='AUTO_SPLIT'
) AS
SELECT * FROM yellow_trip_data_ml
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `model_type`: LINEAR_REG
- `input_label_cols`: tip_amount (—Ü–µ–ª–µ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è)
- `data_split_method`: AUTO_SPLIT

**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** ~5 –º–∏–Ω—É—Ç

#### –û—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–∏

**1. –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–∏–∑–Ω–∞–∫–∞—Ö:**
```sql
SELECT * FROM ML.FEATURE_INFO(MODEL tip_model)
```

–†–µ–∑—É–ª—å—Ç–∞—Ç:
- –ß–∏—Å–ª–æ–≤—ã–µ: passenger_count, trip_distance, fare_amount, tolls_amount
  - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è: min, max, mean (–¥–ª—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏–∏)
- –ö–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ: pickup_location_id, dropoff_location_id, payment_type
  - –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å –ø–æ–¥—Å—á–µ—Ç–æ–º

**2. –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞:**
```sql
SELECT * FROM ML.EVALUATE(MODEL tip_model)
```

–ú–µ—Ç—Ä–∏–∫–∏:
- Mean Absolute Error: ~1
- Mean Squared Error: ~150
- R¬≤

**3. –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è:**
```sql
SELECT * FROM ML.PREDICT(MODEL tip_model, 
  (SELECT * FROM yellow_trip_data_ml))
```

–î–æ–±–∞–≤–ª—è–µ—Ç—Å—è —Å—Ç–æ–ª–±–µ—Ü: `predicted_tip_amount`

**4. –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –º–æ–¥–µ–ª–∏:**
```sql
SELECT * FROM ML.EXPLAIN_PREDICT(MODEL tip_model,
  (SELECT * FROM yellow_trip_data_ml),
  STRUCT(3 as top_k_features))
```

–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–æ–ø-3 –ø—Ä–∏–∑–Ω–∞–∫–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è

#### Hyperparameter Tuning

**–î–æ—Å—Ç—É–ø–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è Linear Regression:**
- `num_trials`: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Å–ø—ã—Ç–∞–Ω–∏–π
- `max_parallel_trials`: –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –∏—Å–ø—ã—Ç–∞–Ω–∏—è
- `l1_reg`: L1 —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è
- `l2_reg`: L2 —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è
- `learn_rate_strategy`
- `min_rel_progress`
- `early_stop`
- `learning_rate`

### 3.4.3 –î–µ–ø–ª–æ–π –º–æ–¥–µ–ª–∏

#### –≠–∫—Å–ø–æ—Ä—Ç –º–æ–¥–µ–ª–∏ –≤ GCS

**1. –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:**
```bash
gcloud auth login
```

**2. –≠–∫—Å–ø–æ—Ä—Ç:**
```sql
EXPORT MODEL `project.dataset.tip_model`
OPTIONS(URI = 'gs://bucket_name/tip_model')
```

**3. –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ:**
```bash
mkdir -p /tmp/model
gsutil cp -r gs://bucket_name/tip_model /tmp/model/
```

#### –î–µ–ø–ª–æ–π —á–µ—Ä–µ–∑ Docker

**1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã:**
```bash
mkdir -p serving_dir/tip_model/1
cp -r /tmp/model/tip_model/* serving_dir/tip_model/1/
```

**2. Pull TensorFlow Serving:**
```bash
docker pull tensorflow/serving
```

**3. –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞:**
```bash
docker run -p 8501:8501 \
  --mount type=bind,source=$(pwd)/serving_dir/tip_model,target=/models/tip_model \
  -e MODEL_NAME=tip_model \
  -t tensorflow/serving
```

**4. –ü—Ä–æ–≤–µ—Ä–∫–∞:**
```bash
# –í–µ—Ä—Å–∏—è –º–æ–¥–µ–ª–∏
curl http://localhost:8501/v1/models/tip_model

# –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ
curl -X POST http://localhost:8501/v1/models/tip_model/versions/1:predict \
  -H 'Content-Type: application/json' \
  -d '{
    "instances": [{
      "passenger_count": 2,
      "trip_distance": 5.5,
      "pickup_location_id": "161",
      "dropoff_location_id": "239",
      "payment_type": "1",
      "fare_amount": 15.0,
      "tolls_amount": 0.0
    }]
  }'
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ tip_amount (–Ω–∞–ø—Ä–∏–º–µ—Ä, ~3.2 –¥–æ–ª–ª–∞—Ä–∞)

---

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–æ–º–∞—à–Ω–µ–≥–æ –∑–∞–¥–∞–Ω–∏—è

### –ó–∞–¥–∞–Ω–∏–µ –Ω–∞ –ø–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—é

**–ê–Ω–∞–ª–∏–∑ taxi dataset:**

1. **–û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –ø–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è:**
   - –ö–∞–∫–æ–π —Å—Ç–æ–ª–±–µ—Ü –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å? (pickup_datetime, dropoff_datetime)
   - –ö–∞–∫–æ–π —Ç–∏–ø –ø–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è? (Daily, Hourly, Monthly)
   - –û–±–æ—Å–Ω—É–π—Ç–µ –≤—ã–±–æ—Ä –Ω–∞ –æ—Å–Ω–æ–≤–µ:
     - –û–±—ä–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö
     - –ß–∞—Å—Ç–æ—Ç—ã –∑–∞–ø—Ä–æ—Å–æ–≤
     - –¢–∏–ø–∏—á–Ω—ã—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤

2. **–í—ã–±–µ—Ä–∏—Ç–µ —Å—Ç–æ–ª–±—Ü—ã –¥–ª—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏:**
   - –î–æ 4 —Å—Ç–æ–ª–±—Ü–æ–≤
   - –†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ: location_id, payment_type, vendor_id
   - **–í–∞–∂–Ω–æ:** –æ–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫
   - –û—Ä–∏–µ–Ω—Ç–∏—Ä—É–π—Ç–µ—Å—å –Ω–∞ —Ç–∏–ø–∏—á–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã

3. **–°–æ–∑–¥–∞–π—Ç–µ –∏ —Å—Ä–∞–≤–Ω–∏—Ç–µ —Ç–∞–±–ª–∏—Ü—ã:**
   - –ë–µ–∑ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
   - –° –ø–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º
   - –° –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–µ–π
   - –° –æ–±–æ–∏–º–∏ –º–µ—Ç–æ–¥–∞–º–∏
   - –°—Ä–∞–≤–Ω–∏—Ç–µ —Å—Ç–æ–∏–º–æ—Å—Ç—å –∏ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤

### –ó–∞–¥–∞–Ω–∏–µ –Ω–∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é –∑–∞–ø—Ä–æ—Å–æ–≤

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ Best Practices:**

1. **–ü–µ—Ä–µ–ø–∏—Å–∞—Ç—å –Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã:**
   - –ó–∞–º–µ–Ω–∏—Ç–µ SELECT * –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Å—Ç–æ–ª–±—Ü—ã
   - –û–ø—Ç–∏–º–∏–∑–∏—Ä—É–π—Ç–µ JOIN (–ø–æ—Ä—è–¥–æ–∫ —Ç–∞–±–ª–∏—Ü)
   - –î–æ–±–∞–≤—å—Ç–µ —Ñ–∏–ª—å—Ç—Ä—ã –ø–æ –ø–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–º —Å—Ç–æ–ª–±—Ü–∞–º

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–æ–∏–º–æ—Å—Ç—å:**
   - –î–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
   - –ü–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
   - –ó–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ —É–ª—É—á—à–µ–Ω–∏—è

### –ó–∞–¥–∞–Ω–∏–µ –Ω–∞ Machine Learning

**–°–æ–∑–¥–∞–π—Ç–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é –º–æ–¥–µ–ª—å:**

1. **–í—ã–±–æ—Ä –∑–∞–¥–∞—á–∏:**
   - –û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å
   - –í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–¥—Ö–æ–¥—è—â–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º

2. **–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö:**
   - Feature engineering
   - –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
   - –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∞–Ω–æ–º–∞–ª–∏–π

3. **–û–±—É—á–µ–Ω–∏–µ –∏ –æ—Ü–µ–Ω–∫–∞:**
   - –°–æ–∑–¥–∞–π—Ç–µ –º–æ–¥–µ–ª—å
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –º–µ—Ç—Ä–∏–∫–∏
   - –í—ã–ø–æ–ª–Ω–∏—Ç–µ hyperparameter tuning
   - –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

4. **–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ:**
   - –≠–∫—Å–ø–æ—Ä—Ç –º–æ–¥–µ–ª–∏
   - –î–µ–ø–ª–æ–π —á–µ—Ä–µ–∑ Docker
   - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API

### –û–±—â–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

**–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- –û–±—ä—è—Å–Ω—è–π—Ç–µ –∫–∞–∂–¥–æ–µ —Ä–µ—à–µ–Ω–∏–µ
- –ü—Ä–∏–≤–æ–¥–∏—Ç–µ –º–µ—Ç—Ä–∏–∫–∏ –¥–æ/–ø–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
- –í–∫–ª—é—á–∞–π—Ç–µ SQL –∑–∞–ø—Ä–æ—Å—ã –≤ –æ—Ç—á–µ—Ç

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–µ–±–æ–ª—å—à–∏–µ —Å—ç–º–ø–ª—ã –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- –ó–∞–ø—É—Å–∫–∞–π—Ç–µ –Ω–∞ –ø–æ–ª–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Ç–æ–ª—å–∫–æ –≥–æ—Ç–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã
- –°–ª–µ–¥–∏—Ç–µ –∑–∞ –ª–∏–º–∏—Ç–∞–º–∏ BigQuery

**–†–µ—Å—É—Ä—Å—ã:**
- –û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è BigQuery
- GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∫—É—Ä—Å–∞
- –ö–æ–º—å—é–Ω–∏—Ç–∏ –¥–ª—è –æ–±—Å—É–∂–¥–µ–Ω–∏—è

---

## –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã

### –ü–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–ª—è —Ç–∞–±–ª–∏—Ü > 1 GB
- ‚úÖ –ü–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ - –¥–ª—è –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –∑–∞—Ç—Ä–∞—Ç –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã–º–∏
- ‚úÖ –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è - –¥–ª—è –≥—Ä–∞–Ω—É–ª—è—Ä–Ω–æ—Å—Ç–∏ –∏ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è - –±–µ—Å–ø–ª–∞—Ç–Ω–æ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

### Best Practices
- ‚úÖ –í—Å–µ–≥–¥–∞ —É–∫–∞–∑—ã–≤–∞–π—Ç–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Å—Ç–æ–ª–±—Ü—ã –≤–º–µ—Å—Ç–æ SELECT *
- ‚úÖ –§–∏–ª—å—Ç—Ä—É–π—Ç–µ –ø–æ –ø–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–º/–∫–ª–∞—Å—Ç–µ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–º —Å—Ç–æ–ª–±—Ü–∞–º
- ‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä—É–π—Ç–µ –ø–æ—Ä—è–¥–æ–∫ —Ç–∞–±–ª–∏—Ü –≤ JOIN
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Å—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–æ–≤ –ø–µ—Ä–µ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- ‚úÖ –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ (Colossus) –∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π (Dremel)
- ‚úÖ Jupiter Network –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Å–∫–æ—Ä–æ—Å—Ç—å –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ - –∫–ª—é—á –∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### Machine Learning
- ‚úÖ BigQuery ML - –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–≤ –±–µ–∑ –∑–Ω–∞–Ω–∏—è Python
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è feature preprocessing
- ‚úÖ –õ–µ–≥–∫–∏–π –¥–µ–ø–ª–æ–π —á–µ—Ä–µ–∑ TensorFlow Serving
- ‚úÖ –°–ª–µ–¥–∏—Ç–µ –∑–∞ —Ü–µ–Ω–∞–º–∏ –∏ –ª–∏–º–∏—Ç–∞–º–∏

---

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã

**–°—Å—ã–ª–∫–∏:**
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è BigQuery: https://cloud.google.com/bigquery/docs
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è BigQuery ML: https://cloud.google.com/bigquery-ml/docs
- GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∫—É—Ä—Å–∞
- Research papers –æ Dremel –∏ BigQuery

**–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:**
1. –ü—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ—Å—å —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ –∏–∑ –∫—É—Ä—Å–∞
2. –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ —Å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –¥–∞—Ç–∞—Å–µ—Ç–∞–º–∏
3. –ò–∑—É—á–∞–π—Ç–µ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ BigQuery
4. –£—á–∞—Å—Ç–≤—É–π—Ç–µ –≤ community discussions

---

**–£—Å–ø–µ—Ö–æ–≤ –≤ –∏–∑—É—á–µ–Ω–∏–∏ BigQuery! üöÄ**